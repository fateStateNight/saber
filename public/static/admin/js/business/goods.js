define(["jquery", "easy-admin", "miniTab"], function ($, ea, miniTab) {    var form = layui.form,        table = layui.table;    var init = {        table_elem: '#currentTable',        table_render_id: 'currentTableRenderId',        index_url: 'business.goods/index',        edit_url: 'business.goods/edit',        claim_url: 'business.goods/claim',        pass_url: 'business.goods/pass',        refuse_url: 'business.goods/refuse',        detail_url: 'business.goods/detail',        export_url: 'business.goods/export',        claim_all_url: 'business.goods/claimAll',        pass_all_url: 'business.goods/passAll',        refuse_all_url: 'business.goods/refuseAll',        getQueryValue: function(queryName){            let query = decodeURI(window.location.search.substring(1));            let vars = query.split("&");            for (var i = 0; i < vars.length; i++) {                let pair = vars[i].split("=");                if (pair[0] === queryName) {                    return pair[1];                }            }            return '';        },    };    let eventId = init.getQueryValue('eventId');    if(eventId.length > 0){        init.index_url = 'business.goods/index?eventId=' + eventId;    }else{        init.index_url = 'business.goods/index';    }    var Controller = {        index: function () {            ea.table.render({                init: init,                //toolbar: ['refresh'],                toolbar: '#toolbarGoods',                cols: [[                    {type: 'checkbox'},                    {field: 'id', title: 'id', hide:true, search:false},                    {field: 'auditorId', title: '审核人ID', hide:true, search:false},                    {field: 'itemId', title: '商品ID', hide:true, searchOp:'='},                    //{field: 'mktItemId', title: '新版商品ID', hide:true},                    {field: 'sellerId', title: '店铺ID', hide:true, search:false},                    {field: 'eventId', title: '活动ID', hide:false, search:false},                    {field: 'shopTitle', title: '店铺名称', fieldAlias:'business_goods.shopTitle'},                    {field: 'title', title: '商品标题', fieldAlias:'business_goods.title'},                    {field: 'auctionUrl', title: '商品链接', templet: ea.table.url, hide:false, search:false},                    {field: 'pictUrl', title: '商品图片', templet: ea.table.image, search:false},                    {field: 'zkFinalPrice', title: '单价', search:false, hide:true},                    {field: 'couponZkFinalPrice', title: '券后价', search:false},                    {field: 'biz30day', title: '销量', hide:true, search:false},                    {field: 'auditStatus', search: 'select', selectList: {0:"所有商品状态",1:"待团长审核",2:"通过",3:"拒绝",5:"取消报名",7:"超级U选通过"}, title: '活动状态'},                    {field: 'auditorNick', title: '审核人', hide:true},                    {field: 'commissionHint', title: '佣金提示', search:false, templet: function(d){                            if(d.commissionHintDesc !== ''){                                showInfo = '<span class="layui-btn layui-btn-xs layui-btn-danger commissionHint-tip" commission-tip-content="'+d.commissionHintDesc+'">'+d.commissionHint+'</span>';                            }else{                                showInfo = '<span class="" >'+d.commissionHint+'</span>';                            }                            return showInfo;                        }},                    {field: 'commissionRate', title: '佣金比率', search:false, templet: ea.table.percent},                    //{field: 'currentCommissionRate', title: '联盟佣金比率', search:false, templet: ea.table.percent},                    {field: 'serviceRate', title: '服务费率', search:false, templet: ea.table.percent},                    {field: 'couponChannelName', title: '优惠券名称', hide:true, search:false},                    {field: 'couponInfo', title: '优惠券信息', hide:true, search:false},                    {field: 'couponLeftCount', title: '优惠券使用数量', hide:true, search:false},                    {field: 'couponTotalCount', title: '优惠券总数', hide:true, search:false},                    {field: 'couponEffectiveStartTime', title: '优惠券开始时间', hide:true, search:false},                    {field: 'couponEffectiveEndTime', title: '优惠券结束时间', hide:true, search:false},                    {field: 'startTime', title: '开始时间', search:'scope'},                    {field: 'endTime', title: '结束时间', search:'scope'},                    {field: 'clickUv', title: '引流UV', hide:true, search:false},                    {field: 'couponUseNum', title: '券使用量', hide:true, search:false},                    {field: 'alipayAmt', title: '付款金额', hide:true, search:false},                    {field: 'alipayNum', title: '付款笔数', hide:true, search:false},                    {field: 'preServiceFee', title: '预估付款服务费', hide:true, search:false},                    {field: 'settleAmt', title: '结算金额', hide:true, search:false},                    {field: 'settleNum', title: '结算笔数', hide:true, search:false},                    {field: 'cmServiceFee', title: '预估结算服务费', hide:true, search:false},                    {field: 'taokeNum', title: '淘宝客数', hide:true, search:false},                    //{width: 250, title: '操作', templet: ea.table.tool},                    {width: 160, title: '操作', toolbar: '#controlPlanGoods'},                ]],                done: function(){                    //表格数据内容增加tip提示                    $('.commissionHint-tip').on('mouseenter', function(){                        let commissionTips = $(this).attr('commission-tip-content');                        this.index = layer.tips('<div style="padding: 10px; font-size: 14px; color: #eee;">'+ commissionTips + '</div>', this, {                            time: -1                            ,maxWidth: 280                            ,tips: [3, '#3A3D49']                        });                    }).on('mouseleave', function(){                        layer.close(this.index);                    });                }            });            //处理鼠标悬停提示            $('*[lay-tips]').on('mouseenter', function(){                let content = $(this).attr('lay-tips');                this.index = layer.tips('<div style="padding: 10px; font-size: 14px; color: #eee;">'+ content + '</div>', this, {                    time: -1                    ,maxWidth: 280                    ,tips: [3, '#3A3D49']                });            }).on('mouseleave', function(){                layer.close(this.index);            });            //处理复选框触发显示隐藏事件            table.on('checkbox', function(obj){                var checkStatus = table.checkStatus('currentTableRenderId');                //循环判断数据状态                //console.log(checkStatus.data);                if(checkStatus.data.length <= 0){                    if(!$("#claimAll").hasClass('claimAll')){                        $("#claimAll").addClass('claimAll');                    }                    if(!$("#passAll").hasClass('claimAll')){                        $("#passAll").addClass('claimAll');                    }                    if(!$("#refuseAll").hasClass('claimAll')){                        $("#refuseAll").addClass('claimAll');                    }                    return false;                }                var status = checkStatus.data[0]['auditStatus'],                    auditorId = checkStatus.data[0]['auditorId'];                $.each(checkStatus.data, function (i, v) {                    if(v.auditStatus !== status){                        ea.msg.error('选中的报名商品状态必须保持一致！');                        return false;                    }                    if(v.auditorId !== auditorId){                        if(auditorId !== '0'){                            ea.msg.error('选中的报名商品必须都已认领！');                        }else{                            ea.msg.error('选中的报名商品中存在认领商品！');                        }                        return false;                    }                });                if(auditorId === '0' && status === 1){                    //出现认领按键                    if($("#claimAll").hasClass('claimAll')){                        $("#claimAll").removeClass('claimAll');                    }else{                        //不处理                    }                }else if(status === 1){                    if($("#passAll").hasClass('claimAll')){                        $("#passAll").removeClass('claimAll');                        $("#refuseAll").removeClass('claimAll');                    }else{                        //不处理                    }                }else{                    //不处理                }            });            /*form.on('checkbox', function(data){                console.log($('body').attr('data-checkbox'));                if($('body').attr('data-checkbox') === 'true'){                    console.log(111);                    console.log($('body').attr('data-checkbox'));                }else{                    console.log(222);                }            });*/            /*$('body').attr('data-checkbox').on('change', function(){                if($(this).attr('data-checkbox') === 'true'){                    console.log(111);                    console.log($(this).attr('data-checkbox'));                }else{                    console.log(222);                }            });*/            miniTab.listen();            ea.listen();        },        edit: function () {            ea.listen();        },        claim: function () {            ea.listen();        },        pass: function () {            ea.listen();        },        refuse: function () {            ea.listen();        },        detail: function () {            //处理鼠标悬停提示            $('*[lay-tips]').on('mouseenter', function(){                var content = $(this).attr('lay-tips');                this.index = layer.tips('<div style="padding: 10px; font-size: 14px; color: #eee;">'+ content + '</div>', this, {                    time: -1                    ,maxWidth: 280                    ,tips: [3, '#3A3D49']                });            }).on('mouseleave', function(){                layer.close(this.index);            });            ea.listen();        },    };    return Controller;});